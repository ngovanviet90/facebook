<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet"
          href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/a11y-dark.min.css">
    <link href="data:image/png;base64,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" rel="icon" type="image/x-icon" />

    <title>Hide post comments has contain URL!</title>
</head>
<body>
<div class="container">
    <h1>Hide post comments has contain URL!</h1>
    <form>
        <div class="form-group">
            <label for="exampleInputEmail1">Facebook token*</label>
            <input type="text" required="required" class="form-control" value="" id="txtToken">
            <small id="emailHelp" class="form-text text-muted">How to get token: <a
                    href="https://han-tools.com/fb-ca/access-token-how" target="_blank">See how</a> |
                <a href="./accessToken" target="_blank">Get AccessToken</a>
            .</small>
        </div>
        <div class="form-group">
            <label for="exampleInputPassword1">Post ID*</label>
            <input type="text" required="required" value="" class="form-control" id="txtPostID">
            <small class="form-text text-muted">Multiple value split by "|", <a
                    href="https://commentpicker.com/facebook-post-id-finder.php" target="_blank">Get PostID</a></small>
        </div>

        <div class="form-group">
            <label for="exampleInputPassword1">Recheck interval:</label>
            <input type="checkbox" checked="true" id="autohide"> <br>Seconds:<input type="number" min="60"
                                                                                    required="required" value="300"
                                                                                    class="form-control" id="txtTime">
        </div>
        <button id="btn_start" type="submit" class="btn btn-primary">Start</button>
    </form>
    <hr>
    <pre id="log" style="height: 350px;overflow-y: auto;"><code class="plaintext"></code></pre>
</div>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script>
    window.fbAsyncInit = function () {
        FB.init({
            appId: '',
            autoLogAppEvents: true,
            xfbml: true,
            version: 'v6.0'
        });
    };
</script>
<script async defer src="https://connect.facebook.net/en_US/sdk.js"></script>
<script>
    var access_token = '';
    var page = 1;
    var after = '';

    function writeLog(message = '') {
        $('#log code').append(message + '\n');
        var objDiv = document.getElementById("log");
        objDiv.scrollTop = objDiv.scrollHeight;
    }

    $(function () {
        try {
            $('form').submit(function (e) {
                e.preventDefault()
            });

            $('#txtToken').change(function () {
                if ($(this).val() != '') createCookie('accessToken', $(this).val());
            });
            $('#txtToken').val(getCookie('accessToken'));
            $('#txtPostID').val(getCookie('listPostID'));

            hljs.initHighlightingOnLoad();
        } catch(err) {
            writeLog('Error: ' + err.message);
        }

        $("#btn_start").on("click", function(){
            try {
                access_token = $('#txtToken').val();
                let listPostID = $('#txtPostID').val();
                if (access_token == '' || listPostID == '') {
                    writeLog('access_token or list post id is empty.');
                    return;
                }
                createCookie('listPostID', listPostID);
                listPostID = listPostID.split("|");
                writeLog('Total: ' + listPostID.length + ' PostId');
                for (let postID of listPostID) {
                    page = 1;
                    after = '';
                    //get Page
                    FB.api(
                        '/' + postID,
                        'GET',
                        {"fields": "from", "access_token": access_token},
                        function (response) {
                            if (response.error) {
                                writeLog('PostID : ' + postID + ', Error :' + response.error.message);
                            } else {
                                //get Page Token
                                FB.api(
                                    '/' + response.from.id,
                                    'GET',
                                    {"fields": "access_token,name", "access_token": access_token},
                                    function (e) {
                                        if (e.error) {
                                            writeLog('PostID : ' + postID + ', Error :' + e.error.message);
                                        } else {
                                            writeLog('Page: ' + e.name + ', PostId: ' + postID);
                                            access_token = e.access_token;
                                            load_comments(postID);
                                        }
                                    }
                                );
                            }
                        }
                    );
                }
                if ($('#autohide:checkbox:checked').length == 1) {
                    let intTime = parseInt($('#txtTime').val());
                    let date = new Date();
                    writeLog('-------------------------- ' + date.getHours() + ':' + date.getMinutes() + '| Recheck in ' + intTime + ' seconds--------------------------');
                    intTime = (intTime < 60) ? 60 * 1000 : intTime * 1000;
                    setTimeout(triggerClick, intTime);
                }
            } catch(err) {
                writeLog('Error: ' + err.message);
                if ($('#autohide:checkbox:checked').length == 1) {
                    let intTime = parseInt($('#txtTime').val());
                    let date = new Date();
                    writeLog('-------------------------- ' + date.getHours() + ':' + date.getMinutes() + '| Recheck in ' + intTime + ' seconds--------------------------');
                    intTime = (intTime < 60) ? 60 * 1000 : intTime * 1000;
                    setTimeout(triggerClick, intTime);
                }
            }
        });
    });

    function load_comments(post_id) {
        try {
            let comments = [];
            FB.api(
                '/' + post_id + '/comments',
                'GET',
                {
                    "fields": "can_hide,is_hidden,message,comments{comments,message,can_hide,is_hidden,from}",
                    'limit': 1000,
                    'after': after,
                    "access_token": access_token
                },
                function (response) {
                    if (response.data) {
                        for (let cmt of response.data) {
                            console.log("PostID: " + post_id + ", Msg: " + cmt.message);
                            if (!cmt.is_hidden && cmt.can_hide && cmt.message.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/)) {
                                comments.push([cmt.id, 'hide', cmt.message]);
                            }
                            if (cmt.comments) {
                                for (let subcmt of cmt.comments.data) {
                                    console.log("PostID: " + post_id + ", Msg: " + subcmt.message);
                                    if (!subcmt.is_hidden && subcmt.can_hide && subcmt.message.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/)) comments.push([subcmt.id, 'delete', subcmt.message]);
                                }
                            }
                        }
                        after = (response.paging && response.paging.cursors.after) ? response.paging.cursors.after : '';
                        hide_comments(comments);
                    }
                }
            );
        } catch(err) {
            writeLog('Error Load Comments: ' + err.message);
        }
    }

    function triggerClick() {
        $('#btn_start').trigger('click');
    }

    function hide_comments(cmts) {
        try {
            if (typeof cmts == undefined || typeof cmts.length == undefined || cmts.length == 0) {
                return;
            }
            let cID = cmts.shift();
            if (cID[1] == 'hide')
                FB.api(
                    '/' + cID[0],
                    'POST',
                    {"is_hidden": "true", 'access_token': access_token},
                    function (response) {
                        if (response.error) {
                            writeLog('PostID : ' + postID + ', Error :' + response.error.message);
                        } else {
                            writeLog('Comment: ' + cID[2] + ' - Hide:' + response.success);
                        }
                    }
                );
            else
                FB.api(
                    '/' + cID[0],
                    'DELETE',
                    {'access_token': access_token},
                    function (response) {
                        if (response.error) {
                            writeLog('PostID : ' + postID + ', Error :' + response.error.message);
                        } else {
                            writeLog('Comment: ' + cID[2] + ' - Delete:' + response.success);
                        }
                    }
                );
        } catch(err) {
            writeLog('Error Hide Comments: ' + err.message);
        }
    }

    function createCookie(name, value, days = 365) {
        try {
            let expires;
            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                expires = "; expires=" + date.toGMTString();
            } else {
                expires = "";
            }
            document.cookie = name + "=" + value + expires + "; path=/";
        } catch(err) {
            writeLog('Error Create Cookie: ' + err.message);
        }
    }

    function getCookie(c_name) {
        try {
            if (document.cookie.length > 0) {
                let c_start = document.cookie.indexOf(c_name + "=");
                if (c_start != -1) {
                    c_start = c_start + c_name.length + 1;
                    let c_end = document.cookie.indexOf(";", c_start);
                    if (c_end == -1) {
                        c_end = document.cookie.length;
                    }
                    return unescape(document.cookie.substring(c_start, c_end));
                }
            }
        } catch(err) {
            writeLog('Error Get Cookie: ' + err.message);
        }
        return "";
    }
</script>
</body>
</html>